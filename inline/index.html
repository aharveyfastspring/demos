<head>
	<link rel="stylesheet" href="democss.css">
	<script
         id="fsc-api"
         src="https://d1f8f9xcsvx3ha.cloudfront.net/sbl/TNP-10608/fastspring-builder.js"
         type="text/javascript"
         data-storefront="aharveyqa.test.qa1.onfastspring.com/inline-aharvey"
         data-data-callback="dataCallback"
         data-continuous="true"></script>
	
</head>

<body onload="fastspring.builder.reset();">
	
	<span data-fsc-item-path="demo-product-1" data-fsc-item-display></span>
	<br />
	<span data-fsc-item-path="demo-product-1" data-fsc-item-price></span>

	<p><button data-fsc-item-path-value="demo-product-1" data-fsc-action="Add">Add To Cart</button></p>

	<span data-fsc-item-path="demo-product-2" data-fsc-item-display></span>
	<br />
	<span data-fsc-item-path="demo-product-2" data-fsc-item-price></span>

	<p><button data-fsc-item-path-value="demo-product-2" data-fsc-action="Add">Add To Cart</button></p>
	
	<span data-fsc-item-path="demo-product-3" data-fsc-item-display></span>
	<br />
	<span data-fsc-item-path="demo-product-3" data-fsc-item-price></span>

	<p><button data-fsc-item-path-value="demo-product-3" data-fsc-action="Add">Add To Cart</button></p>
	
	<span data-fsc-item-path="demo-product-4" data-fsc-item-display></span>
	<br />
	<span data-fsc-item-path="demo-product-4" data-fsc-item-price></span>

	<p><button data-fsc-item-path-value="demo-product-4" data-fsc-action="Add">Add To Cart</button></p>
	
	<h2>Items in Cart <span id="itemsInCart">0</span></h2>
	
	<p><button onclick="buyNow();">Checkout</button></p>
	
	<script>
		
	function buyNow() {
		var orderSession = {
			"paymentContact": {
				"email":"aharvey@fastspring.com",
				"firstName":"Adam",
				"lastName":"Harvey"
			},
			"language":"en"
		};
		
		fastspring.builder.push(orderSession, function(){window.location="./inlinecheckout.html";});
	}
		
	function dataCallback(data) {
	
		var numItemsInCart = 0;	
		
		if (data && data.hasOwnProperty('groups')) {
		const {
		    groups
		} = data;
		groups.forEach(group => {
		    if (group.items && Array.isArray(group.items)) {
			group.items.forEach(item => {

			   if (item.selected) {
				numItemsInCart += parseInt(item.quantity);                                        
			   }
			});
		    }
		});

		}
		console.log(numItemsInCart);
		document.getElementById("itemsInCart").innerHTML = numItemsInCart;
		}
	
	</script>

</body>
